<!DOCTYPE html>
<html
  lang="en"
  xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
  xmlns:th="http://www.thymeleaf.org"
>
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" th:href="@{/css/navbar.css}" />
  </head>
  <body>
    <header class="header">
      <div class="header-container">
        <!-- Top bar with logo, search, and user actions -->
        <div>
          <div class="logo">
            <img
              src="https://ideogram.ai/assets/progressive-image/balanced/response/jJ_0S-HwQPqKmnTgESV2fQ"
              alt="Logo"
            />
            <span>TPQDT Phone</span>
          </div>

          <div class="search-bar">
            <input type="text" placeholder="Tìm kiếm điện thoại, phụ kiện..." />
            <button type="button">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                />
              </svg>
            </button>
          </div>

          <div class="user-actions">
            <div sec:authorize="isAnonymous()">
              <button class="login-btn" onclick="window.location.href='/login'">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"
                  />
                </svg>
                Đăng nhập
              </button>
            </div>

            <div class="dropdown" sec:authorize="isAuthenticated()">
              <a
                      href="#"
                      class="login-btn dropdown-toggle"
                      id="userDropdown"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
              >
                <i class="bi bi-shield-lock-fill me-1" sec:authorize="hasAuthority('ROLE_ADMIN')" title="Quản trị viên"></i>
                <i class="bi bi-cart-fill me-1" sec:authorize="hasAuthority('ROLE_SALES')" title="Bán hàng"></i>
                <i class="bi bi-briefcase-fill me-1" sec:authorize="hasAuthority('ROLE_BUSINESS')" title="Kinh doanh"></i>
                <i class="bi bi-box-fill me-1" sec:authorize="hasAuthority('ROLE_WAREHOUSE')" title="Kho hàng"></i>
                <span sec:authentication="principal.username" class="fw-semibold"></span>
              </a>

              <ul class="dropdown-menu dropdown-menu-end text-small w-100" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" th:href="@{/personal-info}">Thông tin tài khoản</a></li>
                <li><hr class="dropdown-divider"></li>
                <li>
                  <form th:action="@{/logout}" method="post">
                    <button type="submit" class="dropdown-item">Đăng xuất</button>
                  </form>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Navigation menu -->
        <nav class="nav-container">
          <div class="nav-item active" onclick="window.location.href='/'">
            Trang chủ
          </div>
          <div class="nav-item" onclick="window.location.href='/phones'">
            Điện thoại
          </div>
          <div class="nav-item" onclick="window.location.href='/accessories'">
            Phụ kiện
          </div>
          <div class="nav-item" onclick="window.location.href='/promotions'">
            Khuyến mãi
          </div>
          <div class="nav-item" onclick="window.location.href='/news'">
            Tin tức
          </div>
          <div class="nav-item" onclick="window.location.href='/support'">
            Hỗ trợ
          </div>
        </nav>
      </div>
    </header>

    <!-- JavaScript for navbar functionality -->
    <script>
      // Search functionality
      document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.querySelector(".search-bar input");
        const searchButton = document.querySelector(".search-bar button");

        searchButton.addEventListener("click", function () {
          const searchTerm = searchInput.value.trim();
          if (searchTerm) {
            // Implement search functionality here
            console.log("Searching for:", searchTerm);
            // window.location.href = `/search?q=${encodeURIComponent(searchTerm)}`;
          }
        });

        searchInput.addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            searchButton.click();
          }
        });

        // Navigation active state
        const navItems = document.querySelectorAll(".nav-item");
        const currentPath = window.location.pathname;

        navItems.forEach((item) => {
          item.addEventListener("click", function () {
            navItems.forEach((nav) => nav.classList.remove("active"));
            this.classList.add("active");
          });
        });

        // Scroll effect for navbar
        let lastScrollTop = 0;
        window.addEventListener("scroll", function () {
          const header = document.querySelector(".header");
          const scrollTop =
            window.pageYOffset || document.documentElement.scrollTop;

          if (scrollTop > 50) {
            header.classList.add("scrolled");
          } else {
            header.classList.remove("scrolled");
          }

          lastScrollTop = scrollTop;
        });
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
