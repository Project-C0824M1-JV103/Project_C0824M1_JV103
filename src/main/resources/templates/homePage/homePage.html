<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>TPQDT Phone</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" th:href="@{/css/homePage.css}" />
    <link rel="stylesheet" th:href="@{/css/navbar.css}" />
  </head>
  <body>
    <!-- Navbar -->
    <div th:insert="~{navbar/navbar :: body}"></div>

    <!-- Category Navigation -->

    <!-- Hero Section -->
    <div class="hero-section">
      <div class="hero-background"></div>
      <div class="hero-content">
        <div class="hero-text">
          <div class="special-badge">Special offers</div>
          <h1 class="hero-title">Refurbished iPhones</h1>
          <p class="hero-subtitle">
            Smooth, responsive Super Retina XDR display with ProMotion.
          </p>
          <a href="#" class="cta-button">Shop now</a>
        </div>
        <div class="hero-image">
          <div class="carousel-container" id="heroCarousel">
            <div class="carousel-wrapper">
              <div class="carousel-slide">
                <img
                  src="https://cdn.tgdd.vn/Products/Images/42/305658/iphone-15-pro-max-blue-thumbnew-600x600.jpg"
                  alt="iPhone 15 Pro Max"
                />
              </div>
              <div class="carousel-slide">
                <img
                  src="https://cdn.tgdd.vn/Products/Images/42/305658/iphone-15-pro-max-blue-thumbnew-600x600.jpg"
                  alt="Samsung Galaxy S24 Ultra"
                />
              </div>
              <div class="carousel-slide">
                <img
                  src="https://cdn.tgdd.vn/Products/Images/42/305658/iphone-15-pro-max-blue-thumbnew-600x600.jpg"
                  alt="Xiaomi 14 Ultra"
                />
              </div>
            </div>
            <button class="carousel-nav carousel-prev" onclick="previousSlide()">
              <i class="bi bi-chevron-left"></i>
            </button>
            <button class="carousel-nav carousel-next" onclick="nextSlide()">
              <i class="bi bi-chevron-right"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="pagination-dots">
        <div class="dot active"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
    </div>

    <!-- All Products Section -->
    <div class="product-section container mt-5">
      <div class="section-title-container">
        <h2 class="section-title">
          <i class="bi bi-grid-3x3-gap"></i>
          Tất Cả Sản Phẩm
        </h2>
        <p class="section-subtitle">
          Khám phá bộ sưu tập sản phẩm công nghệ mới nhất
        </p>
      </div>

      <!-- Products Grid -->
      <div class="products-grid" th:if="${productPage.hasContent()}">
        <div class="product-card" th:each="product : ${productPage.content}">
          <!-- Product Image -->
          <a th:href="@{'/product/' + ${product.productId}}" class="product-image-wrapper">
            <img th:src="${product.productImages != null && !product.productImages.isEmpty() ? product.productImages[0  ].imageUrl : 'https://via.placeholder.com/300x300.png?text=No+Image'}"
                 th:alt="${product.productName}" class="product-image"/>
          </a>
          <!-- Product Info -->
          <div class="product-info">
            <h3 class="product-name">
              <a th:href="@{'/product/' + ${product.productId}}" th:text="${product.productName}">Product Name</a>
            </h3>
            <p class="product-price" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + ' ₫'">
              10.000.000 ₫
            </p>
          </div>
          <!-- Product Actions -->
          <div class="product-actions">
            <button class="wishlist-btn" title="Thêm vào yêu thích"><i class="bi bi-heart"></i></button>
            <button class="add-to-cart-btn" title="Thêm vào giỏ hàng"><i class="bi bi-cart-plus"></i></button>

          </div>
        </div>
      </div>
      <div class="text-center mt-4" th:if="${!productPage.hasContent()}">
        <p>Không tìm thấy sản phẩm nào.</p>
      </div>

      <!-- Pagination -->
      <nav aria-label="Page navigation" class="pagination-container" th:if="${productPage.totalPages > 1}">
        <ul class="pagination">
          <li th:class="'page-item' + (${!productPage.hasPrevious()} ? ' disabled' : '')">
            <a class="page-link" th:href="@{/(page=${productPage.number - 1}, size=${productPage.size})}">Trước</a>
          </li>
          <li th:each="pageNumber : ${pageNumbers}" th:class="'page-item' + (${pageNumber == productPage.number + 1} ? ' active' : '')">
            <a class="page-link" th:href="@{/(page=${pageNumber - 1}, size=${productPage.size})}" th:text="${pageNumber}">1</a>
          </li>
          <li th:class="'page-item' + (${!productPage.hasNext()} ? ' disabled' : '')">
            <a class="page-link" th:href="@{/(page=${productPage.number + 1}, size=${productPage.size})}">Sau</a>
          </li>
        </ul>
      </nav>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 col-md-6 footer-col">
            <h5 class="footer-title">Về TPQDT Phone</h5>
            <p class="footer-text">TPQDT Phone là cửa hàng chuyên cung cấp các sản phẩm điện thoại chính hãng.</p>
          </div>
          <div class="col-lg-2 col-md-6 footer-col">
            <h5 class="footer-title">Liên kết</h5>
            <ul class="footer-links">
              <li><a href="#">Về chúng tôi</a></li>
              <li><a href="#">Sản phẩm</a></li>
              <li><a href="#">Khuyến mãi</a></li>
              <li><a href="#">Liên hệ</a></li>
            </ul>
          </div>
          <div class="col-lg-3 col-md-6 footer-col">
            <h5 class="footer-title">Hỗ trợ khách hàng</h5>
            <ul class="footer-links">
              <li><a href="#">Chính sách bảo hành</a></li>
              <li><a href="#">Chính sách đổi trả</a></li>
              <li><a href="#">Hướng dẫn mua hàng</a></li>
              <li><a href="#">Câu hỏi thường gặp</a></li>
            </ul>
          </div>
          <div class="col-lg-3 col-md-6 footer-col">
            <h5 class="footer-title">Kết nối với chúng tôi</h5>
            <div class="social-icons">
              <a href="#" class="social-icon"><i class="bi bi-facebook"></i></a>
              <a href="#" class="social-icon"><i class="bi bi-instagram"></i></a>
              <a href="#" class="social-icon"><i class="bi bi-twitter"></i></a>
              <a href="#" class="social-icon"><i class="bi bi-youtube"></i></a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 TPQDT Phone. All Rights Reserved.</p>
        </div>
      </div>
    </footer>


    <!-- JavaScript -->
    <script>
      // Carousel functionality
      let currentSlide = 0;
      const slides = document.querySelectorAll('.carousel-slide');
      const totalSlides = slides.length;
      const carouselWrapper = document.querySelector('.carousel-wrapper');
      const dots = document.querySelectorAll('.dot');
      let autoPlayInterval;

      function updateCarousel() {
        const translateX = -currentSlide * 100;
        carouselWrapper.style.transform = `translateX(${translateX}%)`;
        
        // Update pagination dots
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentSlide);
        });
      }

      function nextSlide() {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateCarousel();
      }

      function previousSlide() {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateCarousel();
      }

      function goToSlide(slideIndex) {
        currentSlide = slideIndex;
        updateCarousel();
      }

      function startAutoPlay() {
        autoPlayInterval = setInterval(nextSlide, 4000); // Auto-advance every 4 seconds
      }

      function stopAutoPlay() {
        clearInterval(autoPlayInterval);
      }

      document.addEventListener('DOMContentLoaded', function() {
        // Initialize carousel
        updateCarousel();
        startAutoPlay();

        // Pause auto-play on hover
        const carouselContainer = document.getElementById('heroCarousel');
        carouselContainer.addEventListener('mouseenter', stopAutoPlay);
        carouselContainer.addEventListener('mouseleave', startAutoPlay);

        // DEBUG: Check all product links
        console.log("=== DEBUG: Checking product links ===");
        document.querySelectorAll('a[href*="/product/"]').forEach((link, index) => {
          console.log(`Product Link ${index + 1}:`, link.href);
        });
        
        // Category navigation
        document.querySelectorAll('.category-item').forEach(item => {
          item.addEventListener('click', function(e) {
            e.preventDefault();
            const categoryName = this.querySelector('.category-name').textContent;
            alert(`Navigating to ${categoryName} category`);
          });
        });

        // Pagination dots for carousel
        document.querySelectorAll('.dot').forEach((dot, index) => {
          dot.addEventListener('click', function() {
            goToSlide(index);
          });
        });
        
        // DEBUG: Add click event to all product links for debugging
        document.querySelectorAll('a[href*="/product/"]').forEach(link => {
          link.addEventListener('click', function(e) {
            console.log("=== DEBUG: Product link clicked ===");
            console.log("URL:", this.href);
            console.log("Product ID:", this.href.split('/product/')[1]);
            
            // Let the default behavior happen (navigation)
            // e.preventDefault(); // Remove this to allow navigation
          });
        });
      });
    </script>
  </body>
</html>
